<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Further Number & Graph Theory — IB Math AI (HL) | MathHub</title>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7322143430416257" crossorigin="anonymous"></script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-99124077"></script>
    <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js',new Date());gtag('config','G-99124077');</script>
    <script>MathJax={tex:{inlineMath:[['$','$'],['\\(','\\)']],displayMath:[['$$','$$'],['\\[','\\]']]}};</script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="stylesheet" href="../assets/css/common.css">
    <style>
        body { font-family: 'Georgia', serif; line-height: 1.8; color: #1e293b; background: #f8fafc; }
        .page-header { background: linear-gradient(135deg, #4c1d95, #7c3aed); color: white; padding: 50px 20px; text-align: center; }
        .page-header h1 { font-size: 2.2em; margin: 0 0 10px; }
        .ib-badge { display: inline-block; background: rgba(255,255,255,0.2); border: 1px solid rgba(255,255,255,0.4); color: white; padding: 4px 12px; border-radius: 12px; font-size: 0.8em; margin: 8px 4px 0; }
        .container { max-width: 900px; margin: 40px auto; padding: 0 20px 60px; }
        h2 { color: #4c1d95; border-bottom: 2px solid #7c3aed; padding-bottom: 8px; margin-top: 48px; }
        h3 { color: #7c3aed; margin-top: 32px; }
        .formula-box { background: #f5f3ff; border: 1px solid #c4b5fd; border-left: 4px solid #7c3aed; border-radius: 8px; padding: 20px 24px; margin: 24px 0; }
        .formula-box h4 { color: #7c3aed; margin: 0 0 12px; font-size: 1em; text-transform: uppercase; letter-spacing: 0.05em; }
        .worked-example { background: white; border: 1px solid #e2e8f0; border-radius: 10px; padding: 24px; margin: 24px 0; box-shadow: 0 2px 6px rgba(0,0,0,0.05); }
        .worked-example .example-label { font-size: 0.8em; font-weight: 700; color: #7c3aed; text-transform: uppercase; letter-spacing: 0.08em; margin-bottom: 8px; }
        .worked-example h4 { color: #4c1d95; margin: 0 0 16px; }
        .step { display: flex; gap: 16px; margin-bottom: 14px; }
        .step-num { background: #7c3aed; color: white; width: 28px; height: 28px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 0.85em; flex-shrink: 0; }
        .practice-section { background: #f5f3ff; border-radius: 10px; padding: 24px; margin: 40px 0; }
        .practice-section h3 { color: #4c1d95; margin-top: 0; }
        .practice-q { background: white; border-radius: 8px; padding: 16px 20px; margin-bottom: 12px; }
        details.solution-toggle summary { cursor: pointer; color: #7c3aed; font-weight: 600; font-size: 0.9em; margin-top: 8px; }
        details.solution-toggle .sol-body { background: #f5f3ff; border-radius: 6px; padding: 14px; margin-top: 8px; }
        .hl-tag { display: inline-block; background: #4c1d95; color: white; font-size: 0.7em; font-weight: 700; padding: 2px 8px; border-radius: 4px; margin-left: 6px; vertical-align: middle; }
        .key-insight { background: #fef9c3; border-left: 4px solid #d97706; border-radius: 6px; padding: 14px 18px; margin: 20px 0; }
        .footer { text-align: center; padding: 30px; color: #64748b; border-top: 1px solid #e2e8f0; margin-top: 60px; font-size: 0.9em; }
        table { width: 100%; border-collapse: collapse; margin: 20px 0; }
        th { background: #4c1d95; color: white; padding: 10px 14px; text-align: left; }
        td { padding: 9px 14px; border-bottom: 1px solid #e2e8f0; }
        tr:nth-child(even) td { background: #f8f4ff; }
    </style>
</head>
<body>
    <nav class="global-nav">
        <a href="/" class="nav-brand">MathHub</a>
        <div class="nav-links">
            <a href="/kr/">KR</a><a href="/us/">US</a><a href="/uk/">UK</a><a href="/ca/">CA</a>
            <a href="/ib/" class="active">IB</a>
            <a href="https://web-production-d0d3e.up.railway.app/" target="_blank" class="nav-cta">Question Bank</a>
        </div>
    </nav>

    <div class="page-header">
        <h1>Further Number &amp; Graph Theory <span class="hl-tag">HL</span></h1>
        <p style="opacity:0.9;margin:8px 0 16px;">Adjacency matrices, spanning trees, Eulerian &amp; Hamiltonian circuits</p>
        <span class="ib-badge">Math AI HL</span>
        <span class="ib-badge">Topic 3 Extension</span>
    </div>

    <div class="container">

        <h2>1. Introduction to Graph Theory</h2>
        <p>Graph theory is the study of <strong>graphs</strong> — mathematical structures used to model pairwise relations between objects. A graph $G = (V, E)$ consists of a set of <strong>vertices</strong> (nodes) $V$ and a set of <strong>edges</strong> $E$ connecting pairs of vertices.</p>

        <h3>Key Terminology</h3>
        <table>
            <tr><th>Term</th><th>Definition</th><th>Example</th></tr>
            <tr><td>Vertex (node)</td><td>A point in the graph</td><td>City in a road network</td></tr>
            <tr><td>Edge (arc)</td><td>A connection between two vertices</td><td>Road between two cities</td></tr>
            <tr><td>Degree of a vertex</td><td>Number of edges incident to it</td><td>$\deg(v) = 3$ means 3 edges meet at $v$</td></tr>
            <tr><td>Simple graph</td><td>No loops, no multiple edges</td><td>Standard undirected graph</td></tr>
            <tr><td>Multigraph</td><td>Multiple edges allowed between vertices</td><td>Two roads between same cities</td></tr>
            <tr><td>Directed graph (digraph)</td><td>Edges have direction (arrows)</td><td>One-way streets</td></tr>
            <tr><td>Weighted graph</td><td>Each edge has a numerical weight</td><td>Road network with distances</td></tr>
        </table>

        <div class="formula-box">
            <h4>Handshaking Lemma</h4>
            <p>For any graph $G$, the sum of all vertex degrees equals twice the number of edges:</p>
            $$\sum_{v \in V} \deg(v) = 2|E|$$
            <p><strong>Consequence:</strong> The number of vertices with odd degree is always even.</p>
        </div>

        <h3>Types of Graphs</h3>
        <ul>
            <li><strong>Complete graph $K_n$</strong>: every pair of vertices is connected. Has $\frac{n(n-1)}{2}$ edges.</li>
            <li><strong>Bipartite graph</strong>: vertices split into two disjoint sets $A, B$; edges only go between $A$ and $B$.</li>
            <li><strong>Connected graph</strong>: there is a path between every pair of vertices.</li>
            <li><strong>Tree</strong>: connected graph with no cycles; a tree with $n$ vertices has exactly $n-1$ edges.</li>
            <li><strong>Subgraph</strong>: a graph formed from a subset of vertices and edges of a larger graph.</li>
        </ul>

        <h2>2. Adjacency Matrices</h2>
        <p>An <strong>adjacency matrix</strong> $A$ is an $n \times n$ matrix where $a_{ij}$ represents the number of edges from vertex $i$ to vertex $j$.</p>

        <div class="formula-box">
            <h4>Adjacency Matrix Properties</h4>
            <ul>
                <li>For an <strong>undirected</strong> graph: $A$ is symmetric ($a_{ij} = a_{ji}$)</li>
                <li>For a <strong>simple</strong> graph: all diagonal entries $a_{ii} = 0$ (no self-loops)</li>
                <li>The $(i,j)$ entry of $A^2$ gives the number of <strong>walks of length 2</strong> from vertex $i$ to vertex $j$</li>
                <li>More generally, $(A^k)_{ij}$ = number of walks of length $k$ from $i$ to $j$</li>
                <li>The degree of vertex $i$ = row sum (or column sum for undirected) of row $i$</li>
            </ul>
        </div>

        <div class="worked-example">
            <div class="example-label">Worked Example 1</div>
            <h4>Constructing an Adjacency Matrix</h4>
            <p>A graph has vertices $A, B, C, D$ with edges: $AB$, $AC$, $BC$, $BD$, $CD$. Construct the adjacency matrix and find the number of walks of length 2 from $A$ to $D$.</p>

            <div class="step">
                <div class="step-num">1</div>
                <div><strong>Label rows and columns</strong> with vertices $A, B, C, D$. Enter 1 if an edge exists, 0 otherwise.
                $$A = \begin{pmatrix} 0 & 1 & 1 & 0 \\ 1 & 0 & 1 & 1 \\ 1 & 1 & 0 & 1 \\ 0 & 1 & 1 & 0 \end{pmatrix}$$
                </div>
            </div>
            <div class="step">
                <div class="step-num">2</div>
                <div><strong>Verify degrees</strong> using row sums: $\deg(A)=2$, $\deg(B)=3$, $\deg(C)=3$, $\deg(D)=2$. Check: $2+3+3+2=10=2\times 5$ edges. ✓</div>
            </div>
            <div class="step">
                <div class="step-num">3</div>
                <div><strong>Compute $A^2$</strong> to find walks of length 2. The $(1,4)$ entry of $A^2$ (row $A$, column $D$):
                $$[A^2]_{AD} = (0)(0)+(1)(1)+(1)(1)+(0)(0) = 0+1+1+0 = 2$$
                So there are <strong>2 walks of length 2</strong> from $A$ to $D$: $A \to B \to D$ and $A \to C \to D$.
                </div>
            </div>
        </div>

        <h2>3. Minimum Spanning Trees</h2>
        <p>A <strong>spanning tree</strong> of a connected graph is a subgraph that is a tree containing all $n$ vertices (and exactly $n-1$ edges). A <strong>minimum spanning tree (MST)</strong> is a spanning tree with the smallest possible total edge weight.</p>

        <div class="key-insight">
            <strong>Why MSTs matter:</strong> MSTs solve real-world problems like designing the cheapest road/cable network connecting all cities, or minimising pipeline length in an oil field.
        </div>

        <h3>Kruskal's Algorithm</h3>
        <p>Sort all edges by weight (ascending). Add edges one by one, skipping any edge that would create a cycle. Stop when $n-1$ edges have been added.</p>

        <div class="formula-box">
            <h4>Kruskal's Algorithm — Steps</h4>
            <ol>
                <li>List all edges in non-decreasing order of weight</li>
                <li>Pick the lightest edge. Add it to the MST if it does not form a cycle</li>
                <li>Repeat step 2 until $n-1$ edges have been selected</li>
                <li>If an edge would connect two vertices already in the same connected component, reject it (cycle detection)</li>
            </ol>
            <p><strong>Time complexity:</strong> $O(E \log E)$ for sorting.</p>
        </div>

        <h3>Prim's Algorithm</h3>
        <p>Start from any vertex. Greedily add the cheapest edge connecting a vertex in the current tree to a vertex not yet in the tree. Repeat until all vertices are included.</p>

        <div class="formula-box">
            <h4>Prim's Algorithm — Steps</h4>
            <ol>
                <li>Choose any starting vertex; mark it as part of the MST</li>
                <li>Find the minimum-weight edge connecting any MST vertex to any non-MST vertex</li>
                <li>Add that edge and the new vertex to the MST</li>
                <li>Repeat steps 2–3 until all vertices are in the MST</li>
            </ol>
            <p><strong>Key difference from Kruskal:</strong> Prim's grows a single connected component; Kruskal's may add isolated edges that eventually merge.</p>
        </div>

        <div class="worked-example">
            <div class="example-label">Worked Example 2</div>
            <h4>Applying Kruskal's Algorithm</h4>
            <p>A weighted graph has 5 vertices $\{A,B,C,D,E\}$ with edges and weights: $AB=3$, $AC=5$, $BC=2$, $BD=6$, $BE=4$, $CD=1$, $CE=7$, $DE=5$. Find the MST using Kruskal's algorithm.</p>

            <div class="step">
                <div class="step-num">1</div>
                <div><strong>Sort edges by weight:</strong> $CD=1$, $BC=2$, $AB=3$, $BE=4$, $AC=5$, $DE=5$, $BD=6$, $CE=7$</div>
            </div>
            <div class="step">
                <div class="step-num">2</div>
                <div><strong>Add $CD=1$</strong>: no cycle. MST = $\{CD\}$. Components: $\{A\},\{B\},\{C,D\},\{E\}$</div>
            </div>
            <div class="step">
                <div class="step-num">3</div>
                <div><strong>Add $BC=2$</strong>: no cycle. MST = $\{CD, BC\}$. Components: $\{A\},\{B,C,D\},\{E\}$</div>
            </div>
            <div class="step">
                <div class="step-num">4</div>
                <div><strong>Add $AB=3$</strong>: no cycle. MST = $\{CD, BC, AB\}$. Components: $\{A,B,C,D\},\{E\}$</div>
            </div>
            <div class="step">
                <div class="step-num">5</div>
                <div><strong>Add $BE=4$</strong>: no cycle — connects $E$ to tree. MST = $\{CD, BC, AB, BE\}$. ✓ $n-1=4$ edges. Stop.</div>
            </div>
            <div class="step">
                <div class="step-num">6</div>
                <div><strong>MST total weight:</strong> $1+2+3+4 = \mathbf{10}$. The MST uses edges $CD, BC, AB, BE$.</div>
            </div>
        </div>

        <h2>4. Eulerian and Hamiltonian Paths</h2>

        <h3>Eulerian Paths and Circuits</h3>
        <p>An <strong>Eulerian path</strong> traverses every edge exactly once. An <strong>Eulerian circuit</strong> is an Eulerian path that starts and ends at the same vertex.</p>

        <div class="formula-box">
            <h4>Euler's Theorems</h4>
            <ul>
                <li>A connected graph has an <strong>Eulerian circuit</strong> if and only if <strong>every vertex has even degree</strong></li>
                <li>A connected graph has an <strong>Eulerian path</strong> (not a circuit) if and only if it has <strong>exactly two vertices of odd degree</strong> (the path starts and ends at these vertices)</li>
                <li>If there are more than two odd-degree vertices, no Eulerian path exists</li>
            </ul>
        </div>

        <div class="key-insight">
            <strong>Historical context:</strong> Euler solved the Königsberg Bridge Problem (1736) — can you cross all 7 bridges of Königsberg exactly once? The answer is no: the graph of bridges has 4 vertices of odd degree. This is considered the birth of graph theory.
        </div>

        <h3>Hamiltonian Paths and Circuits</h3>
        <p>A <strong>Hamiltonian path</strong> visits every vertex exactly once. A <strong>Hamiltonian circuit</strong> returns to the starting vertex after visiting every other vertex exactly once.</p>

        <ul>
            <li>No simple efficient algorithm exists to determine Hamiltonian circuits — this is an NP-complete problem</li>
            <li>For IB purposes: determine by <strong>inspection</strong> (trial and error for small graphs)</li>
            <li><strong>Dirac's theorem:</strong> If every vertex in a simple graph with $n \geq 3$ vertices has degree $\geq n/2$, then the graph has a Hamiltonian circuit</li>
        </ul>

        <div class="worked-example">
            <div class="example-label">Worked Example 3</div>
            <h4>Determining Eulerian Circuits</h4>
            <p>A graph has 6 vertices with degrees 2, 3, 4, 3, 2, 4. Does an Eulerian circuit exist? Does an Eulerian path exist?</p>

            <div class="step">
                <div class="step-num">1</div>
                <div><strong>Count odd-degree vertices:</strong> Degrees are 2, <u>3</u>, 4, <u>3</u>, 2, 4. There are <strong>2 odd-degree vertices</strong>.</div>
            </div>
            <div class="step">
                <div class="step-num">2</div>
                <div><strong>Eulerian circuit:</strong> Requires ALL vertices to have even degree. Since 2 vertices have odd degree, <strong>no Eulerian circuit exists</strong>.</div>
            </div>
            <div class="step">
                <div class="step-num">3</div>
                <div><strong>Eulerian path:</strong> Requires exactly 2 odd-degree vertices. We have exactly 2. So <strong>an Eulerian path exists</strong>, starting and ending at the two odd-degree vertices.</div>
            </div>
        </div>

        <h2>5. The Chinese Postman Problem</h2>
        <p>The <strong>Chinese Postman Problem</strong> (Route Inspection) asks: what is the shortest closed walk that traverses every edge at least once? This models a postman delivering to every street and returning to the depot.</p>

        <ul>
            <li>If all vertices have even degree: the graph is Eulerian, and the answer is simply the sum of all edge weights</li>
            <li>If there are odd-degree vertices: add the minimum-weight set of extra edges (repeat edges) to make all degrees even, then find the Eulerian circuit</li>
            <li>For IB: typically 2 or 4 odd-degree vertices — find minimum-weight matching of odd-degree pairs</li>
        </ul>

        <div class="formula-box">
            <h4>Chinese Postman — Algorithm</h4>
            <ol>
                <li>Find all odd-degree vertices</li>
                <li>Find the minimum-weight pairing of these vertices (consider all possible pairings)</li>
                <li>Add repeated edges along shortest paths between paired vertices</li>
                <li>Total route length = sum of all edges + weight of added repeated edges</li>
            </ol>
        </div>

        <h2>6. The Travelling Salesman Problem (TSP)</h2>
        <p>The <strong>Travelling Salesman Problem</strong>: find the shortest Hamiltonian circuit in a complete weighted graph (visit every city exactly once and return to start).</p>

        <p>The TSP is NP-hard — no known polynomial-time exact algorithm. For IB, we use approximation:</p>

        <div class="formula-box">
            <h4>Nearest Neighbour Algorithm (Greedy Heuristic)</h4>
            <ol>
                <li>Start at any vertex</li>
                <li>Move to the nearest unvisited vertex</li>
                <li>Repeat until all vertices are visited</li>
                <li>Return to the starting vertex</li>
            </ol>
            <p><strong>Note:</strong> This gives a good approximation but not necessarily the optimal solution. The result depends on the starting vertex chosen.</p>
        </div>

        <div class="key-insight">
            <strong>Lower bound method:</strong> Delete one vertex and its edges. Find MST of remaining graph. Add back the two cheapest edges from the deleted vertex. This gives a lower bound for the optimal TSP solution.
        </div>

        <div class="practice-section">
            <h3>Practice Problems</h3>

            <div class="practice-q">
                <p><strong>1.</strong> A graph has vertices $P, Q, R, S$ with edges $PQ=4$, $PR=7$, $PS=2$, $QR=3$, $QS=6$, $RS=5$. Use Kruskal's algorithm to find the minimum spanning tree and state its total weight.</p>
                <details class="solution-toggle">
                    <summary>Show Solution</summary>
                    <div class="sol-body">
                        <p>Sort edges: $PS=2$, $QR=3$, $PQ=4$, $RS=5$, $QS=6$, $PR=7$</p>
                        <p>Add $PS=2$ ✓, Add $QR=3$ ✓, Add $PQ=4$ ✓ (connects $\{P,S\}$ to $\{Q,R\}$). Now all 4 vertices connected with 3 edges. Stop.</p>
                        <p><strong>MST edges:</strong> $PS, QR, PQ$ &nbsp;|&nbsp; <strong>Total weight:</strong> $2+3+4 = \mathbf{9}$</p>
                    </div>
                </details>
            </div>

            <div class="practice-q">
                <p><strong>2.</strong> A connected graph has 8 vertices. Their degrees are: 4, 2, 3, 5, 2, 3, 4, 3. Determine whether an Eulerian circuit exists, and whether an Eulerian path exists.</p>
                <details class="solution-toggle">
                    <summary>Show Solution</summary>
                    <div class="sol-body">
                        <p>Odd-degree vertices: 3, 5, 3, 3 — that is <strong>4 vertices with odd degree</strong>.</p>
                        <p><strong>Eulerian circuit:</strong> Requires 0 odd-degree vertices. Does NOT exist.</p>
                        <p><strong>Eulerian path:</strong> Requires exactly 2 odd-degree vertices. Does NOT exist (4 odd-degree vertices).</p>
                        <p>To make an Eulerian circuit, we'd need to add repeated edges to convert all 4 odd-degree vertices to even — this is the Chinese Postman approach.</p>
                    </div>
                </details>
            </div>

            <div class="practice-q">
                <p><strong>3.</strong> The adjacency matrix of a graph is $A = \begin{pmatrix} 0&1&1&0\\ 1&0&0&1\\ 1&0&0&1\\ 0&1&1&0 \end{pmatrix}$. Find the number of walks of length 2 from vertex 1 to vertex 4, and list all such walks.</p>
                <details class="solution-toggle">
                    <summary>Show Solution</summary>
                    <div class="sol-body">
                        <p>$(A^2)_{14}$ = row 1 of $A$ dotted with column 4 of $A$: $(0)(0)+(1)(1)+(1)(1)+(0)(0) = 2$.</p>
                        <p><strong>Two walks of length 2:</strong> $1 \to 2 \to 4$ and $1 \to 3 \to 4$.</p>
                    </div>
                </details>
            </div>
        </div>

        <div style="background:#4c1d95;color:white;border-radius:10px;padding:24px;text-align:center;margin-top:40px;">
            <h3 style="margin:0 0 10px;color:white;">Continue Learning</h3>
            <p style="opacity:0.9;margin-bottom:18px;">Explore other IB Math AI HL topics</p>
            <a href="/ib/" style="display:inline-block;background:#7c3aed;color:white;padding:10px 24px;border-radius:8px;text-decoration:none;font-weight:700;margin:4px;">Back to IB Hub</a>
            <a href="ib-ai-further-statistics.html" style="display:inline-block;background:rgba(255,255,255,0.15);color:white;padding:10px 24px;border-radius:8px;text-decoration:none;font-weight:700;margin:4px;">Further Statistics &rarr;</a>
        </div>
    </div>

    <div class="footer"><p>&copy; 2026 MathHub Global. All rights reserved.</p></div>
    <script src="../assets/js/common.js"></script>
</body>
</html>
# SVG Geometry Diagram Verification Rules

## MANDATORY: Run bkit:code-analyzer agent before any fix

## Verification Checklist (must pass before commit)

### 1. Angle Arc Direction (BUG-001)
- Arc sweep-flag must be OUTWARD from vertex (away from angle interior)
- Left vertices: sweep=0 | Right vertices: sweep=1
- Cross-product rule: cross2D(arm1, arm2) < 0 â†’ sweep=0, > 0 â†’ sweep=1

### 2. Vertex Label Overlap (BUG-003)
- **Rule:** Any two labels at same y-level (|y2-y1| < 5px) must have |x2-x1| â‰¥ 15px
- **Preferred:** â‰¥ 20px separation
- **Check:** When two triangles share an edge or are adjacent, check the inner pair of labels
- Common danger zone: rightmost label of triangle 1 vs leftmost label of triangle 2

### 3. Tick Mark Direction
- Tick marks must be PERPENDICULAR to the side they mark
- Direction (dy, dx) for side with direction (dx, dy) â€” NOT parallel to side

### 4. Duplicate Stroke Lines
- Never draw an explicit `<line>` for an edge that is already drawn by a `<polygon>`
- Check: if polygon covers segment AB, remove any `<line x1=Ax y1=Ay x2=Bx y2=By>`

### 5. CPCTC Text Placement
- CPCTC labels must appear OUTSIDE all triangle polygons

### 6. SVG Overflow / Coordinate Bounds (BUG-004)
- **Rule:** ALL polygon/path/text coordinates must stay INSIDE the viewBox
- **Check:** For viewBox `"x0 y0 w h"`, every coordinate must satisfy `x0 â‰¤ x â‰¤ x0+w` and `y0 â‰¤ y â‰¤ y0+h`
- **Danger zone:** Squares on the hypotenuse â€” the outward perpendicular can push vertices FAR outside bounds
- **Hyp square formula:** For hyp from P1â†’P2 (dir=(dx,dy)), outward perp = rotate CW = (dy,âˆ’dx). Square: P1 â†’ P2 â†’ P2+(dy,âˆ’dx) â†’ P1+(dy,âˆ’dx). Verify ALL four vertices against viewBox before writing.
- **Safety net:** Always add `overflow: hidden` to `.figure-card` CSS
- **Fix pattern:** Reposition triangle so the hyp square opens toward the larger empty area of the viewBox. Example: right angle at bottom-right â†’ hyp square opens upper-left.

<claude-mem-context>
# Recent Activity

<!-- This section is auto-generated by claude-mem. Edit content outside the tags. -->

### Feb 27, 2026

| ID | Time | T | Title | Read |
|----|------|---|-------|------|
| #10249 | 4:27 PM | ðŸ”´ | Fixed SAS triangle coordinate calculation syntax for GeoGebra compatibility | ~372 |
| #10245 | 3:40 PM | ðŸ”´ | SAS triangle visibility fixed on initial page load | ~279 |
| #10237 | 3:20 PM | ðŸ”„ | GeoGebra Interactive Applets Initialization Refactored | ~375 |
| #10227 | 3:05 PM | ðŸŸ£ | Triangle Congruence Educational Page Created with SVG Figures | ~569 |
</claude-mem-context>